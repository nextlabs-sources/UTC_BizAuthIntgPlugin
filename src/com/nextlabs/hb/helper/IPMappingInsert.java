package com.nextlabs.hb.helper;import java.util.ArrayList;import java.util.HashMap;import org.apache.commons.logging.Log;import org.apache.commons.logging.LogFactory;public class IPMappingInsert {	private static final Log log = LogFactory.getLog(IPMappingInsert.class);	private HSQLHelper hsqlHelper;	HashMap<String, ArrayList<HashMap<String, String>>> responseData;	public IPMappingInsert(			HashMap<String, ArrayList<HashMap<String, String>>> responseData) {		this.responseData = responseData;		hsqlHelper = new HSQLHelper(				PluginConstants.COMMON_PROPS.getProperty("hsql_server_url"),				PluginConstants.COMMON_PROPS.getProperty("hsql_user_name"),				PluginConstants.COMMON_PROPS.getProperty("hsql_password"));	}	public void insertData() {		truncateTable();		insertIPMappingData();	}	private void insertIPMappingData() {		log.info("responseData:" + responseData);		InsertQueryHelper iqh = new InsertQueryHelper();		iqh.initalize(PluginConstants.COMMON_PROPS				.getProperty("table_IPMapping"));		ArrayList<HashMap<String, String>> ipMappingData = responseData.get(iqh				.getTableName());		log.info("afterresponse data.get" + ipMappingData);		if (ipMappingData != null) {			iqh.getFieldList().add(					PluginConstants.COMMON_PROPS.getProperty("ipm_col_id"));			iqh.getFieldList().add(					PluginConstants.COMMON_PROPS.getProperty("ipm_col_ipcdir"));			iqh.getFieldList().add(					PluginConstants.COMMON_PROPS							.getProperty("ipm_col_CountryCode"));			iqh.getFieldList().add(					PluginConstants.COMMON_PROPS.getProperty("ipm_col_type"));			iqh.prepareQuery();			log.info(iqh.getQuery());			hsqlHelper.insertData(iqh, ipMappingData);		}	}	private void truncateTable() {		InsertQueryHelper iqh = new InsertQueryHelper();		iqh.initalize("");		iqh.getFieldList().add(				PluginConstants.COMMON_PROPS.getProperty("table_IPMapping"));		hsqlHelper.truncatetables(iqh);	}}